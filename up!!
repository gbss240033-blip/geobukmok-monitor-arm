import RPi.GPIO as GPIO
from time import sleep

# ----------------------------
# GPIO Setup
# ----------------------------
GPIO.setmode(GPIO.BCM)
GPIO.setwarnings(False)

# í•˜ë¶€ ëª¨í„° í•€
Ena1, In1A, In1B = 2, 3, 4
GPIO.setup(Ena1, GPIO.OUT)
GPIO.setup(In1A, GPIO.OUT)
GPIO.setup(In1B, GPIO.OUT)

# ìƒë¶€ ëª¨í„° í•€
Ena2, In2A, In2B = 17, 22, 27
GPIO.setup(Ena2, GPIO.OUT)
GPIO.setup(In2A, GPIO.OUT)
GPIO.setup(In2B, GPIO.OUT)

# PWM ì„¤ì •
pwm1 = GPIO.PWM(Ena1, 100)  # 100Hz
pwm1.start(50)              # 50% ì†ë„

pwm2 = GPIO.PWM(Ena2, 100)
pwm2.start(50)

# ----------------------------
# Motor Control Functions
# ----------------------------
def motor1_up():
    GPIO.output(In1A, GPIO.LOW)
    GPIO.output(In1B, GPIO.HIGH)

def motor2_up():
    GPIO.output(In2A, GPIO.LOW)
    GPIO.output(In2B, GPIO.HIGH)

def stop_all():
    GPIO.output(In1A, GPIO.LOW)
    GPIO.output(In1B, GPIO.LOW)
    GPIO.output(In2A, GPIO.LOW)
    GPIO.output(In2B, GPIO.LOW)
    pwm1.ChangeDutyCycle(0)
    pwm2.ChangeDutyCycle(0)

# ----------------------------
# Main Loop
# ----------------------------
try:
    print("ğŸ”¼ í•˜ë¶€/ìƒë¶€ ëª¨í„° ëª¨ë‘ ê³„ì† ìœ„ë¡œ íšŒì „")
    motor1_up()
    motor2_up()
    while True:
        sleep(0.1)  # CPU ê³¼ë¶€í•˜ ë°©ì§€

except KeyboardInterrupt:
    print("ğŸ›‘ ì‚¬ìš©ì ì¤‘ë‹¨")

finally:
    stop_all()
    pwm1.stop()
    pwm2.stop()
    GPIO.cleanup()
    print("í”„ë¡œê·¸ë¨ ì¢…ë£Œ")
